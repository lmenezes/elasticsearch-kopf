// isDefined tests
var main = JSON.parse('{ "name" : "Swarm", "cluster_name" : "elasticsearch", "version" : { "number" : "2.0.0", "build_hash" : "de54438d6af8f9340d50c5c786151783ce7d6be5", "build_timestamp" : "2015-10-22T08:09:48Z", "build_snapshot" : false, "lucene_version" : "5.2.1" }, "tagline" : "You Know, for Search"}');
test("cluster creating", function() {
  var state = JSON.parse('{"cluster_name":"elasticsearch","master_node":"JABXlsAfSWmjZ1YdzFsn9A","blocks":{"indices":{"qux":{"4":{"description":"index closed","retryable":false,"levels":["read","write"]}}}},"nodes":{"JABXlsAfSWmjZ1YdzFsn9A":{"name":"Maur-Konn","transport_address":"127.0.0.1:9300","attributes":{}},"4KsHvWKoQsiwQ7MJr0CpDA":{"name":"Nosferata","transport_address":"127.0.0.1:9301","attributes":{}}},"routing_table":{"indices":{"foobar":{"shards":{"1":[{"state":"STARTED","primary":true,"node":"JABXlsAfSWmjZ1YdzFsn9A","relocating_node":null,"shard":1,"index":"foobar","version":2,"allocation_id":{"id":"iAx8JVl2QVmhc1ttLHPGQQ"}}],"0":[{"state":"STARTED","primary":true,"node":"4KsHvWKoQsiwQ7MJr0CpDA","relocating_node":null,"shard":0,"index":"foobar","version":2,"allocation_id":{"id":"TiagPPg5Qp2ksOn2zWnLTA"}}]}},"foobaz":{"shards":{"0":[{"state":"STARTED","primary":true,"node":"4KsHvWKoQsiwQ7MJr0CpDA","relocating_node":null,"shard":0,"index":"foobaz","version":3,"allocation_id":{"id":"OOFFxN-lT4OdTa9BqVA_cg"}},{"state":"STARTED","primary":false,"node":"JABXlsAfSWmjZ1YdzFsn9A","relocating_node":null,"shard":0,"index":"foobaz","version":3,"allocation_id":{"id":"FQJQZmPXQd2DaWQGxXwniw"}},{"state":"UNASSIGNED","primary":false,"node":null,"relocating_node":null,"shard":0,"index":"foobaz","version":3,"unassigned_info":{"reason":"INDEX_CREATED","at":"2015-10-28T17:14:44.477Z"}}]}}}}}');
  var indexStats = JSON.parse('{"_shards":{"total":5,"successful":4,"failed":0},"_all":{"primaries":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":381,"throttle_time_in_millis":0}},"total":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":508,"throttle_time_in_millis":0}}},"indices":{"foobar":{"primaries":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0}},"total":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0}}},"foobaz":{"primaries":{"docs":{"count":0,"deleted":0},"store":{"size_in_bytes":127,"throttle_time_in_millis":0}},"total":{"docs":{"count":0,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0}}}}}');
  var nodeStats = JSON.parse('{"cluster_name":"elasticsearch","nodes":{"4KsHvWKoQsiwQ7MJr0CpDA":{"timestamp":1446052486381,"name":"Nosferata","transport_address":"127.0.0.1:9301","host":"127.0.0.1","ip":["127.0.0.1:9301","NONE"],"indices":{"docs":{"count":2,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0},"indexing":{"index_total":2,"index_time_in_millis":55,"index_current":0,"delete_total":0,"delete_time_in_millis":0,"delete_current":0,"noop_update_total":0,"is_throttled":false,"throttle_time_in_millis":0},"get":{"total":0,"time_in_millis":0,"exists_total":0,"exists_time_in_millis":0,"missing_total":0,"missing_time_in_millis":0,"current":0},"search":{"open_contexts":0,"query_total":0,"query_time_in_millis":0,"query_current":0,"fetch_total":0,"fetch_time_in_millis":0,"fetch_current":0,"scroll_total":0,"scroll_time_in_millis":0,"scroll_current":0},"merges":{"current":0,"current_docs":0,"current_size_in_bytes":0,"total":0,"total_time_in_millis":0,"total_docs":0,"total_size_in_bytes":0,"total_stopped_time_in_millis":0,"total_throttled_time_in_millis":0,"total_auto_throttle_in_bytes":62914560},"refresh":{"total":3,"total_time_in_millis":227},"flush":{"total":0,"total_time_in_millis":0},"warmer":{"current":0,"total":6,"total_time_in_millis":27},"query_cache":{"memory_size_in_bytes":0,"total_count":0,"hit_count":0,"miss_count":0,"cache_size":0,"cache_count":0,"evictions":0},"fielddata":{"memory_size_in_bytes":0,"evictions":0},"percolate":{"total":0,"time_in_millis":0,"current":0,"memory_size_in_bytes":-1,"memory_size":"-1b","queries":0},"completion":{"size_in_bytes":0},"segments":{"count":1,"memory_in_bytes":3140,"terms_memory_in_bytes":2696,"stored_fields_memory_in_bytes":312,"term_vectors_memory_in_bytes":0,"norms_memory_in_bytes":40,"doc_values_memory_in_bytes":92,"index_writer_memory_in_bytes":0,"index_writer_max_memory_in_bytes":134217728,"version_map_memory_in_bytes":0,"fixed_bit_set_memory_in_bytes":144},"translog":{"operations":2,"size_in_bytes":242},"suggest":{"total":0,"time_in_millis":0,"current":0},"request_cache":{"memory_size_in_bytes":0,"evictions":0,"hit_count":0,"miss_count":0},"recovery":{"current_as_source":0,"current_as_target":0,"throttle_time_in_millis":0}},"os":{"timestamp":1446052486385,"load_average":3.41845703125,"mem":{"total_in_bytes":8589934592,"free_in_bytes":16728064,"used_in_bytes":8573206528,"free_percent":0,"used_percent":100},"swap":{"total_in_bytes":3221225472,"free_in_bytes":783810560,"used_in_bytes":2437414912}},"process":{"timestamp":1446052486386,"open_file_descriptors":262,"max_file_descriptors":10240,"cpu":{"percent":1,"total_in_millis":9645},"mem":{"total_virtual_in_bytes":5299920896}},"jvm":{"timestamp":1446052486386,"uptime_in_millis":29624,"mem":{"heap_used_in_bytes":71560536,"heap_used_percent":6,"heap_committed_in_bytes":259522560,"heap_max_in_bytes":1037959168,"non_heap_used_in_bytes":49027984,"non_heap_committed_in_bytes":50233344,"pools":{"young":{"used_in_bytes":54535024,"max_in_bytes":286326784,"peak_used_in_bytes":71630848,"peak_max_in_bytes":286326784},"survivor":{"used_in_bytes":8338752,"max_in_bytes":35782656,"peak_used_in_bytes":8912896,"peak_max_in_bytes":35782656},"old":{"used_in_bytes":8686760,"max_in_bytes":715849728,"peak_used_in_bytes":9538672,"peak_max_in_bytes":715849728}}},"threads":{"count":83,"peak_count":83},"gc":{"collectors":{"young":{"collection_count":4,"collection_time_in_millis":50},"old":{"collection_count":1,"collection_time_in_millis":11}}},"buffer_pools":{"direct":{"count":77,"used_in_bytes":13643902,"total_capacity_in_bytes":13643902},"mapped":{"count":0,"used_in_bytes":0,"total_capacity_in_bytes":0}}},"thread_pool":{"bulk":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_started":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_store":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"flush":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"generic":{"threads":4,"queue":0,"active":0,"rejected":0,"largest":4,"completed":63},"get":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"index":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":2},"listener":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"management":{"threads":2,"queue":0,"active":1,"rejected":0,"largest":2,"completed":20},"optimize":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"percolate":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"refresh":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":3},"search":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"snapshot":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"suggest":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"warmer":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":6}},"fs":{"timestamp":1446052486387,"total":{"total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424},"data":[{"path":"/Users/leonardo.menezes/Downloads/elastic/elasticsearch-2.0.0/data/elasticsearch/nodes/1","mount":"/ (/dev/disk1)","type":"hfs","total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424}]},"transport":{"server_open":13,"rx_count":135,"rx_size_in_bytes":20942,"tx_count":134,"tx_size_in_bytes":111876},"http":{"current_open":0,"total_opened":0},"breakers":{"request":{"limit_size_in_bytes":415183667,"limit_size":"395.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0},"fielddata":{"limit_size_in_bytes":622775500,"limit_size":"593.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.03,"tripped":0},"parent":{"limit_size_in_bytes":726571417,"limit_size":"692.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0}},"script":{"compilations":0,"cache_evictions":0}},"JABXlsAfSWmjZ1YdzFsn9A":{"timestamp":1446052486380,"name":"Maur-Konn","transport_address":"127.0.0.1:9300","host":"127.0.0.1","ip":["127.0.0.1:9300","NONE"],"indices":{"docs":{"count":6,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0},"indexing":{"index_total":6,"index_time_in_millis":84,"index_current":0,"delete_total":0,"delete_time_in_millis":0,"delete_current":0,"noop_update_total":0,"is_throttled":false,"throttle_time_in_millis":0},"get":{"total":0,"time_in_millis":0,"exists_total":0,"exists_time_in_millis":0,"missing_total":0,"missing_time_in_millis":0,"current":0},"search":{"open_contexts":0,"query_total":0,"query_time_in_millis":0,"query_current":0,"fetch_total":0,"fetch_time_in_millis":0,"fetch_current":0,"scroll_total":0,"scroll_time_in_millis":0,"scroll_current":0},"merges":{"current":0,"current_docs":0,"current_size_in_bytes":0,"total":0,"total_time_in_millis":0,"total_docs":0,"total_size_in_bytes":0,"total_stopped_time_in_millis":0,"total_throttled_time_in_millis":0,"total_auto_throttle_in_bytes":62914560},"refresh":{"total":2,"total_time_in_millis":110},"flush":{"total":0,"total_time_in_millis":0},"warmer":{"current":0,"total":7,"total_time_in_millis":40},"query_cache":{"memory_size_in_bytes":0,"total_count":0,"hit_count":0,"miss_count":0,"cache_size":0,"cache_count":0,"evictions":0},"fielddata":{"memory_size_in_bytes":0,"evictions":0},"percolate":{"total":0,"time_in_millis":0,"current":0,"memory_size_in_bytes":-1,"memory_size":"-1b","queries":0},"completion":{"size_in_bytes":0},"segments":{"count":1,"memory_in_bytes":3140,"terms_memory_in_bytes":2696,"stored_fields_memory_in_bytes":312,"term_vectors_memory_in_bytes":0,"norms_memory_in_bytes":40,"doc_values_memory_in_bytes":92,"index_writer_memory_in_bytes":0,"index_writer_max_memory_in_bytes":134217728,"version_map_memory_in_bytes":0,"fixed_bit_set_memory_in_bytes":72},"translog":{"operations":6,"size_in_bytes":554},"suggest":{"total":0,"time_in_millis":0,"current":0},"request_cache":{"memory_size_in_bytes":0,"evictions":0,"hit_count":0,"miss_count":0},"recovery":{"current_as_source":0,"current_as_target":0,"throttle_time_in_millis":0}},"os":{"timestamp":1446052486385,"load_average":3.41845703125,"mem":{"total_in_bytes":8589934592,"free_in_bytes":16728064,"used_in_bytes":8573206528,"free_percent":0,"used_percent":100},"swap":{"total_in_bytes":3221225472,"free_in_bytes":783810560,"used_in_bytes":2437414912}},"process":{"timestamp":1446052486385,"open_file_descriptors":269,"max_file_descriptors":10240,"cpu":{"percent":2,"total_in_millis":11995},"mem":{"total_virtual_in_bytes":5296005120}},"jvm":{"timestamp":1446052486385,"uptime_in_millis":112118,"mem":{"heap_used_in_bytes":39629216,"heap_used_percent":3,"heap_committed_in_bytes":259522560,"heap_max_in_bytes":1037959168,"non_heap_used_in_bytes":52022368,"non_heap_committed_in_bytes":52817920,"pools":{"young":{"used_in_bytes":18641688,"max_in_bytes":286326784,"peak_used_in_bytes":71630848,"peak_max_in_bytes":286326784},"survivor":{"used_in_bytes":8713504,"max_in_bytes":35782656,"peak_used_in_bytes":8912888,"peak_max_in_bytes":35782656},"old":{"used_in_bytes":12274024,"max_in_bytes":715849728,"peak_used_in_bytes":12274024,"peak_max_in_bytes":715849728}}},"threads":{"count":79,"peak_count":80},"gc":{"collectors":{"young":{"collection_count":5,"collection_time_in_millis":60},"old":{"collection_count":1,"collection_time_in_millis":16}}},"buffer_pools":{"direct":{"count":131,"used_in_bytes":22063045,"total_capacity_in_bytes":22063045},"mapped":{"count":0,"used_in_bytes":0,"total_capacity_in_bytes":0}},"classes":{"current_loaded_count":7343,"total_loaded_count":7343,"total_unloaded_count":0}},"thread_pool":{"bulk":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_started":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_store":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"flush":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"generic":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":4,"completed":56},"get":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"index":{"threads":6,"queue":0,"active":0,"rejected":0,"largest":6,"completed":6},"listener":{"threads":4,"queue":0,"active":0,"rejected":0,"largest":4,"completed":161},"management":{"threads":2,"queue":0,"active":1,"rejected":0,"largest":2,"completed":88},"optimize":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"percolate":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"refresh":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":2},"search":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"snapshot":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"suggest":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"warmer":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":6}},"fs":{"timestamp":1446052486386,"total":{"total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424},"data":[{"path":"/Users/leonardo.menezes/Downloads/elastic/elasticsearch-2.0.0/data/elasticsearch/nodes/0","mount":"/ (/dev/disk1)","type":"hfs","total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424}]},"transport":{"server_open":13,"rx_count":134,"rx_size_in_bytes":111876,"tx_count":135,"tx_size_in_bytes":20942},"http":{"current_open":7,"total_opened":29},"breakers":{"request":{"limit_size_in_bytes":415183667,"limit_size":"395.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0},"fielddata":{"limit_size_in_bytes":622775500,"limit_size":"593.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.03,"tripped":0},"parent":{"limit_size_in_bytes":726571417,"limit_size":"692.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0}},"script":{"compilations":0,"cache_evictions":0}}}}');
  var settings = JSON.parse('{"foobar":{"settings":{"index":{"creation_date":"1446052483693","analysis":{"analyzer":{"index_inc_search":{"filter":["lowercase"],"tokenizer":"whitespace"}}},"number_of_shards":"2","number_of_replicas":"0","uuid":"BzQapH-qT8GWdrOCm-mFKg","version":{"created":"2000099"}}}},"foobaz":{"settings":{"index":{"creation_date":"1446052484466","analysis":{"analyzer":{"index_inc_search":{"filter":["lowercase"],"tokenizer":"whitespace"}}},"number_of_shards":"1","number_of_replicas":"2","uuid":"mPg_arqrREiXzhnhi0w6jg","version":{"created":"2000099"}}}}}');
  var aliases = JSON.parse('{"foobar":{"aliases":{}},"foobaz":{"aliases":{}}}');
  var health = JSON.parse('{"cluster_name":"elasticsearch","status":"yellow","timed_out":false,"number_of_nodes":2,"number_of_data_nodes":2,"active_primary_shards":3,"active_shards":4,"relocating_shards":0,"initializing_shards":0,"unassigned_shards":1,"delayed_unassigned_shards":0,"number_of_pending_tasks":0,"number_of_in_flight_fetch":0,"task_max_waiting_in_queue_millis":0,"active_shards_percent_as_number":80.0}');
  var nodes = JSON.parse('{"cluster_name":"elasticsearch","nodes":{"4KsHvWKoQsiwQ7MJr0CpDA":{"name":"Nosferata","transport_address":"127.0.0.1:9301","host":"127.0.0.1","ip":"127.0.0.1","version":"2.0.0","build":"de54438","http_address":"127.0.0.1:9201","os":{"refresh_interval_in_millis":1000,"available_processors":8},"jvm":{"pid":31338,"version":"1.8.0_40","vm_name":"Java HotSpot(TM) 64-Bit Server VM","vm_version":"25.40-b25","vm_vendor":"Oracle Corporation","start_time_in_millis":1446052456821,"mem":{"heap_init_in_bytes":268435456,"heap_max_in_bytes":1037959168,"non_heap_init_in_bytes":2555904,"non_heap_max_in_bytes":0,"direct_max_in_bytes":1037959168},"gc_collectors":["ParNew","ConcurrentMarkSweep"],"memory_pools":["Code Cache","Metaspace","Compressed Class Space","Par Eden Space","Par Survivor Space","CMS Old Gen"]}},"JABXlsAfSWmjZ1YdzFsn9A":{"name":"Maur-Konn","transport_address":"127.0.0.1:9300","host":"127.0.0.1","ip":"127.0.0.1","version":"2.0.0","build":"de54438","http_address":"127.0.0.1:9200","os":{"refresh_interval_in_millis":1000,"name":"Mac OS X","arch":"x86_64","version":"10.10.5","available_processors":8},"jvm":{"pid":31005,"version":"1.8.0_40","vm_name":"Java HotSpot(TM) 64-Bit Server VM","vm_version":"25.40-b25","vm_vendor":"Oracle Corporation","start_time_in_millis":1446052374353,"mem":{"heap_init_in_bytes":268435456,"heap_max_in_bytes":1037959168,"non_heap_init_in_bytes":2555904,"non_heap_max_in_bytes":0,"direct_max_in_bytes":1037959168},"gc_collectors":["ParNew","ConcurrentMarkSweep"],"memory_pools":["Code Cache","Metaspace","Compressed Class Space","Par Eden Space","Par Survivor Space","CMS Old Gen"]}}}}');
  var cluster = new Cluster(health, state, indexStats, nodeStats, settings, aliases, nodes, main);

  var size_pattern = /\d+\.\d+\w{1,2}/;
  var number_pattern = /\d+/;

  // check client name
  equal(cluster.clientName, 'Swarm', "Check client name");
  // check clustercluster properties
  equal(cluster.num_docs, 8, "Number of documents");
  //equal(cluster.total_size == '16.49KB', "Checking total size");
  equal(cluster.unassigned_shards, 1, "Unassigned shards");
  equal(cluster.shards, 5, "Number of shards");
  equal(cluster.total_indices, 3, "Number of indices");
  var master_node = cluster.master_node;

  // index info
  ok(cluster.indices.length, 3, "Indices list length");

  var indices = cluster.indices;
  indices.forEach(function(index) {
    ok(index.state == 'open' || index.state == 'close',
        "Checking index state: [" + index.state + "]");
    if (index.state == 'open') {
      ok(number_pattern.test(index.size_in_bytes),
          "Checking primary size: [" + index.size_in_bytes + "]");
      ok(number_pattern.test(index.total_size_in_bytes),
          "Checking total size: [" + index.total_size_in_bytes + "]");
    }
    ok(number_pattern.test(index.num_docs),
        "Checking num docs: [" + index.num_docs + "]");
    ok(number_pattern.test(index.deleted_docs),
        "Checking deleted docs: [" + index.deleted_docs + "]");
    ok(index.name.length > 0, "Checking index name: [" + index.name + "]");
    ok(number_pattern.test(index.num_of_shards),
        "Checking number of shards: [" + index.num_of_shards + "]");
    ok(number_pattern.test(index.num_of_replicas),
        "Checking number of replicas: [" + index.num_of_replicas + "]");
    var node_ids = cluster.getNodes(true).map(function(node) {
      return node.id;
    });
    node_ids.forEach(function(node_id) {
      indices.forEach(function(index) {
        var shards = cluster.getShards(node_id, index);
        if (shards.length > 0) {
          shards.forEach(function(shard) {
            ok(isDefined(shard.id), "Id property is defined");
            ok(isDefined(shard.shard), "shard property is defined");
            ok(isDefined(shard.state), "state property is defined");
            ok(isDefined(shard.node), "node property is defined");
            ok(isDefined(shard.index), "index property is defined");
          })
        }
      });
      if (cluster.getShards(node_id, index.id) != null) {
        cluster.getShards(node_id, index.id).forEach(function(shard) {
          ok(shard.primary == true || shard.primary == false,
              "Checking primary status: [" + shard.primary + "]");
          equal(shard.node, node_id,
              "Shards should have referece to correct node");
          ok(shard.state == 'STARTED',
              "Shards should be started: [" + shard.state + "]");
        });
      }
    });

  });

  // check nodes
  var nodes = cluster.getNodes();
  equal(nodes.length, 2, "Unfiltered node list");
  var master_nodes = 0;
  nodes.forEach(function(node) {
    ok(number_pattern.test(node.disk_total_in_bytes),
        "Checking disk total [" + node.disk_total_in_bytes + "]");
    ok(number_pattern.test(node.disk_free_in_bytes),
        "Checking free disk [" + node.disk_free_in_bytes + "]");
    ok(node.disk_used_percent >= 0 && node.disk_used_percent <= 100,
        "Checking disk usage in percent [" + node.disk_used_percent + "]");
    ok(size_pattern.test(node.heap_used),
        "Checking node heap used [" + node.heap_used + "]");
    ok(size_pattern.test(node.heap_committed),
        "Checking node heap commited [" + node.heap_committed + "]");
    ok(size_pattern.test(node.heap_max),
        "Checking max heap size [" + node.heap_max + "]");
    ok(node.heap_used_percent >= 0 && node.heap_used_percent <= 100,
        "Checking heap used percent [" + node.heap_used_percent + "]");
    ok(node.cpu >= 0 && number_pattern.test(node.cpu),
        "Checking process cpu [" + node.cpu + "]");
    equal(node.id.length, 22, "Checking node id length");
    equal(node.jvmVersion, '1.8.0_40', "Checking node jvm version");
    equal(node.elasticVersion, '2.0.0', "Checking node es version");
    if (node.current_master) {
      master_nodes += 1;
      equal(master_node, node.id, "Checking current master");
    }
  });
  equal(master_nodes, 1, "There should be exactly one master node");
});

test("computing cluster changes", function() {
  var state = JSON.parse('{"cluster_name":"elasticsearch","master_node":"JABXlsAfSWmjZ1YdzFsn9A","blocks":{"indices":{"qux":{"4":{"description":"index closed","retryable":false,"levels":["read","write"]}}}},"nodes":{"JABXlsAfSWmjZ1YdzFsn9A":{"name":"Maur-Konn","transport_address":"127.0.0.1:9300","attributes":{}},"4KsHvWKoQsiwQ7MJr0CpDA":{"name":"Nosferata","transport_address":"127.0.0.1:9301","attributes":{}}},"routing_table":{"indices":{"foobar":{"shards":{"1":[{"state":"STARTED","primary":true,"node":"JABXlsAfSWmjZ1YdzFsn9A","relocating_node":null,"shard":1,"index":"foobar","version":2,"allocation_id":{"id":"iAx8JVl2QVmhc1ttLHPGQQ"}}],"0":[{"state":"STARTED","primary":true,"node":"4KsHvWKoQsiwQ7MJr0CpDA","relocating_node":null,"shard":0,"index":"foobar","version":2,"allocation_id":{"id":"TiagPPg5Qp2ksOn2zWnLTA"}}]}},"foobaz":{"shards":{"0":[{"state":"STARTED","primary":true,"node":"4KsHvWKoQsiwQ7MJr0CpDA","relocating_node":null,"shard":0,"index":"foobaz","version":3,"allocation_id":{"id":"OOFFxN-lT4OdTa9BqVA_cg"}},{"state":"STARTED","primary":false,"node":"JABXlsAfSWmjZ1YdzFsn9A","relocating_node":null,"shard":0,"index":"foobaz","version":3,"allocation_id":{"id":"FQJQZmPXQd2DaWQGxXwniw"}},{"state":"UNASSIGNED","primary":false,"node":null,"relocating_node":null,"shard":0,"index":"foobaz","version":3,"unassigned_info":{"reason":"INDEX_CREATED","at":"2015-10-28T17:14:44.477Z"}}]}}}}}');
  var indexStats = JSON.parse('{"_shards":{"total":5,"successful":4,"failed":0},"_all":{"primaries":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":281,"throttle_time_in_millis":0}},"total":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":408,"throttle_time_in_millis":0}}},"indices":{"foobar":{"primaries":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":154,"throttle_time_in_millis":0}},"total":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":154,"throttle_time_in_millis":0}}},"foobaz":{"primaries":{"docs":{"count":0,"deleted":0},"store":{"size_in_bytes":127,"throttle_time_in_millis":0}},"total":{"docs":{"count":0,"deleted":0},"store":{"size_in_bytes":154,"throttle_time_in_millis":0}}}}}');
  var nodeStats = JSON.parse('{"cluster_name":"elasticsearch","nodes":{"4KsHvWKoQsiwQ7MJr0CpDA":{"timestamp":1446052486381,"name":"Nosferata","transport_address":"127.0.0.1:9301","host":"127.0.0.1","ip":["127.0.0.1:9301","NONE"],"indices":{"docs":{"count":2,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0},"indexing":{"index_total":2,"index_time_in_millis":55,"index_current":0,"delete_total":0,"delete_time_in_millis":0,"delete_current":0,"noop_update_total":0,"is_throttled":false,"throttle_time_in_millis":0},"get":{"total":0,"time_in_millis":0,"exists_total":0,"exists_time_in_millis":0,"missing_total":0,"missing_time_in_millis":0,"current":0},"search":{"open_contexts":0,"query_total":0,"query_time_in_millis":0,"query_current":0,"fetch_total":0,"fetch_time_in_millis":0,"fetch_current":0,"scroll_total":0,"scroll_time_in_millis":0,"scroll_current":0},"merges":{"current":0,"current_docs":0,"current_size_in_bytes":0,"total":0,"total_time_in_millis":0,"total_docs":0,"total_size_in_bytes":0,"total_stopped_time_in_millis":0,"total_throttled_time_in_millis":0,"total_auto_throttle_in_bytes":62914560},"refresh":{"total":3,"total_time_in_millis":227},"flush":{"total":0,"total_time_in_millis":0},"warmer":{"current":0,"total":6,"total_time_in_millis":27},"query_cache":{"memory_size_in_bytes":0,"total_count":0,"hit_count":0,"miss_count":0,"cache_size":0,"cache_count":0,"evictions":0},"fielddata":{"memory_size_in_bytes":0,"evictions":0},"percolate":{"total":0,"time_in_millis":0,"current":0,"memory_size_in_bytes":-1,"memory_size":"-1b","queries":0},"completion":{"size_in_bytes":0},"segments":{"count":1,"memory_in_bytes":3140,"terms_memory_in_bytes":2696,"stored_fields_memory_in_bytes":312,"term_vectors_memory_in_bytes":0,"norms_memory_in_bytes":40,"doc_values_memory_in_bytes":92,"index_writer_memory_in_bytes":0,"index_writer_max_memory_in_bytes":134217728,"version_map_memory_in_bytes":0,"fixed_bit_set_memory_in_bytes":144},"translog":{"operations":2,"size_in_bytes":242},"suggest":{"total":0,"time_in_millis":0,"current":0},"request_cache":{"memory_size_in_bytes":0,"evictions":0,"hit_count":0,"miss_count":0},"recovery":{"current_as_source":0,"current_as_target":0,"throttle_time_in_millis":0}},"os":{"timestamp":1446052486385,"load_average":3.41845703125,"mem":{"total_in_bytes":8589934592,"free_in_bytes":16728064,"used_in_bytes":8573206528,"free_percent":0,"used_percent":100},"swap":{"total_in_bytes":3221225472,"free_in_bytes":783810560,"used_in_bytes":2437414912}},"process":{"timestamp":1446052486386,"open_file_descriptors":262,"max_file_descriptors":10240,"cpu":{"percent":1,"total_in_millis":9645},"mem":{"total_virtual_in_bytes":5299920896}},"jvm":{"timestamp":1446052486386,"uptime_in_millis":29624,"mem":{"heap_used_in_bytes":71560536,"heap_used_percent":6,"heap_committed_in_bytes":259522560,"heap_max_in_bytes":1037959168,"non_heap_used_in_bytes":49027984,"non_heap_committed_in_bytes":50233344,"pools":{"young":{"used_in_bytes":54535024,"max_in_bytes":286326784,"peak_used_in_bytes":71630848,"peak_max_in_bytes":286326784},"survivor":{"used_in_bytes":8338752,"max_in_bytes":35782656,"peak_used_in_bytes":8912896,"peak_max_in_bytes":35782656},"old":{"used_in_bytes":8686760,"max_in_bytes":715849728,"peak_used_in_bytes":9538672,"peak_max_in_bytes":715849728}}},"threads":{"count":83,"peak_count":83},"gc":{"collectors":{"young":{"collection_count":4,"collection_time_in_millis":50},"old":{"collection_count":1,"collection_time_in_millis":11}}},"buffer_pools":{"direct":{"count":77,"used_in_bytes":13643902,"total_capacity_in_bytes":13643902},"mapped":{"count":0,"used_in_bytes":0,"total_capacity_in_bytes":0}}},"thread_pool":{"bulk":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_started":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_store":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"flush":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"generic":{"threads":4,"queue":0,"active":0,"rejected":0,"largest":4,"completed":63},"get":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"index":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":2},"listener":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"management":{"threads":2,"queue":0,"active":1,"rejected":0,"largest":2,"completed":20},"optimize":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"percolate":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"refresh":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":3},"search":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"snapshot":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"suggest":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"warmer":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":6}},"fs":{"timestamp":1446052486387,"total":{"total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424},"data":[{"path":"/Users/leonardo.menezes/Downloads/elastic/elasticsearch-2.0.0/data/elasticsearch/nodes/1","mount":"/ (/dev/disk1)","type":"hfs","total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424}]},"transport":{"server_open":13,"rx_count":135,"rx_size_in_bytes":20942,"tx_count":134,"tx_size_in_bytes":111876},"http":{"current_open":0,"total_opened":0},"breakers":{"request":{"limit_size_in_bytes":415183667,"limit_size":"395.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0},"fielddata":{"limit_size_in_bytes":622775500,"limit_size":"593.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.03,"tripped":0},"parent":{"limit_size_in_bytes":726571417,"limit_size":"692.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0}},"script":{"compilations":0,"cache_evictions":0}},"JABXlsAfSWmjZ1YdzFsn9A":{"timestamp":1446052486380,"name":"Maur-Konn","transport_address":"127.0.0.1:9300","host":"127.0.0.1","ip":["127.0.0.1:9300","NONE"],"indices":{"docs":{"count":6,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0},"indexing":{"index_total":6,"index_time_in_millis":84,"index_current":0,"delete_total":0,"delete_time_in_millis":0,"delete_current":0,"noop_update_total":0,"is_throttled":false,"throttle_time_in_millis":0},"get":{"total":0,"time_in_millis":0,"exists_total":0,"exists_time_in_millis":0,"missing_total":0,"missing_time_in_millis":0,"current":0},"search":{"open_contexts":0,"query_total":0,"query_time_in_millis":0,"query_current":0,"fetch_total":0,"fetch_time_in_millis":0,"fetch_current":0,"scroll_total":0,"scroll_time_in_millis":0,"scroll_current":0},"merges":{"current":0,"current_docs":0,"current_size_in_bytes":0,"total":0,"total_time_in_millis":0,"total_docs":0,"total_size_in_bytes":0,"total_stopped_time_in_millis":0,"total_throttled_time_in_millis":0,"total_auto_throttle_in_bytes":62914560},"refresh":{"total":2,"total_time_in_millis":110},"flush":{"total":0,"total_time_in_millis":0},"warmer":{"current":0,"total":7,"total_time_in_millis":40},"query_cache":{"memory_size_in_bytes":0,"total_count":0,"hit_count":0,"miss_count":0,"cache_size":0,"cache_count":0,"evictions":0},"fielddata":{"memory_size_in_bytes":0,"evictions":0},"percolate":{"total":0,"time_in_millis":0,"current":0,"memory_size_in_bytes":-1,"memory_size":"-1b","queries":0},"completion":{"size_in_bytes":0},"segments":{"count":1,"memory_in_bytes":3140,"terms_memory_in_bytes":2696,"stored_fields_memory_in_bytes":312,"term_vectors_memory_in_bytes":0,"norms_memory_in_bytes":40,"doc_values_memory_in_bytes":92,"index_writer_memory_in_bytes":0,"index_writer_max_memory_in_bytes":134217728,"version_map_memory_in_bytes":0,"fixed_bit_set_memory_in_bytes":72},"translog":{"operations":6,"size_in_bytes":554},"suggest":{"total":0,"time_in_millis":0,"current":0},"request_cache":{"memory_size_in_bytes":0,"evictions":0,"hit_count":0,"miss_count":0},"recovery":{"current_as_source":0,"current_as_target":0,"throttle_time_in_millis":0}},"os":{"timestamp":1446052486385,"load_average":3.41845703125,"mem":{"total_in_bytes":8589934592,"free_in_bytes":16728064,"used_in_bytes":8573206528,"free_percent":0,"used_percent":100},"swap":{"total_in_bytes":3221225472,"free_in_bytes":783810560,"used_in_bytes":2437414912}},"process":{"timestamp":1446052486385,"open_file_descriptors":269,"max_file_descriptors":10240,"cpu":{"percent":2,"total_in_millis":11995},"mem":{"total_virtual_in_bytes":5296005120}},"jvm":{"timestamp":1446052486385,"uptime_in_millis":112118,"mem":{"heap_used_in_bytes":39629216,"heap_used_percent":3,"heap_committed_in_bytes":259522560,"heap_max_in_bytes":1037959168,"non_heap_used_in_bytes":52022368,"non_heap_committed_in_bytes":52817920,"pools":{"young":{"used_in_bytes":18641688,"max_in_bytes":286326784,"peak_used_in_bytes":71630848,"peak_max_in_bytes":286326784},"survivor":{"used_in_bytes":8713504,"max_in_bytes":35782656,"peak_used_in_bytes":8912888,"peak_max_in_bytes":35782656},"old":{"used_in_bytes":12274024,"max_in_bytes":715849728,"peak_used_in_bytes":12274024,"peak_max_in_bytes":715849728}}},"threads":{"count":79,"peak_count":80},"gc":{"collectors":{"young":{"collection_count":5,"collection_time_in_millis":60},"old":{"collection_count":1,"collection_time_in_millis":16}}},"buffer_pools":{"direct":{"count":131,"used_in_bytes":22063045,"total_capacity_in_bytes":22063045},"mapped":{"count":0,"used_in_bytes":0,"total_capacity_in_bytes":0}},"classes":{"current_loaded_count":7343,"total_loaded_count":7343,"total_unloaded_count":0}},"thread_pool":{"bulk":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_started":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_store":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"flush":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"generic":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":4,"completed":56},"get":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"index":{"threads":6,"queue":0,"active":0,"rejected":0,"largest":6,"completed":6},"listener":{"threads":4,"queue":0,"active":0,"rejected":0,"largest":4,"completed":161},"management":{"threads":2,"queue":0,"active":1,"rejected":0,"largest":2,"completed":88},"optimize":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"percolate":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"refresh":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":2},"search":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"snapshot":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"suggest":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"warmer":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":6}},"fs":{"timestamp":1446052486386,"total":{"total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424},"data":[{"path":"/Users/leonardo.menezes/Downloads/elastic/elasticsearch-2.0.0/data/elasticsearch/nodes/0","mount":"/ (/dev/disk1)","type":"hfs","total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424}]},"transport":{"server_open":13,"rx_count":134,"rx_size_in_bytes":111876,"tx_count":135,"tx_size_in_bytes":20942},"http":{"current_open":7,"total_opened":29},"breakers":{"request":{"limit_size_in_bytes":415183667,"limit_size":"395.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0},"fielddata":{"limit_size_in_bytes":622775500,"limit_size":"593.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.03,"tripped":0},"parent":{"limit_size_in_bytes":726571417,"limit_size":"692.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0}},"script":{"compilations":0,"cache_evictions":0}}}}');
  var settings = JSON.parse('{"foobar":{"settings":{"index":{"creation_date":"1446052483693","analysis":{"analyzer":{"index_inc_search":{"filter":["lowercase"],"tokenizer":"whitespace"}}},"number_of_shards":"2","number_of_replicas":"0","uuid":"BzQapH-qT8GWdrOCm-mFKg","version":{"created":"2000099"}}}},"foobaz":{"settings":{"index":{"creation_date":"1446052484466","analysis":{"analyzer":{"index_inc_search":{"filter":["lowercase"],"tokenizer":"whitespace"}}},"number_of_shards":"1","number_of_replicas":"2","uuid":"mPg_arqrREiXzhnhi0w6jg","version":{"created":"2000099"}}}}}');
  var aliases = JSON.parse('{"foobar":{"aliases":{}},"foobaz":{"aliases":{}}}');
  var health = JSON.parse('{"cluster_name":"elasticsearch","status":"yellow","timed_out":false,"number_of_nodes":2,"number_of_data_nodes":2,"active_primary_shards":3,"active_shards":4,"relocating_shards":0,"initializing_shards":0,"unassigned_shards":1,"delayed_unassigned_shards":0,"number_of_pending_tasks":0,"number_of_in_flight_fetch":0,"task_max_waiting_in_queue_millis":0,"active_shards_percent_as_number":80.0}');
  var nodes = JSON.parse('{"cluster_name":"elasticsearch","nodes":{"4KsHvWKoQsiwQ7MJr0CpDA":{"name":"Nosferata","transport_address":"127.0.0.1:9301","host":"127.0.0.1","ip":"127.0.0.1","version":"2.0.0","build":"de54438","http_address":"127.0.0.1:9201","os":{"refresh_interval_in_millis":1000,"available_processors":8},"jvm":{"pid":31338,"version":"1.8.0_40","vm_name":"Java HotSpot(TM) 64-Bit Server VM","vm_version":"25.40-b25","vm_vendor":"Oracle Corporation","start_time_in_millis":1446052456821,"mem":{"heap_init_in_bytes":268435456,"heap_max_in_bytes":1037959168,"non_heap_init_in_bytes":2555904,"non_heap_max_in_bytes":0,"direct_max_in_bytes":1037959168},"gc_collectors":["ParNew","ConcurrentMarkSweep"],"memory_pools":["Code Cache","Metaspace","Compressed Class Space","Par Eden Space","Par Survivor Space","CMS Old Gen"]}},"JABXlsAfSWmjZ1YdzFsn9A":{"name":"Maur-Konn","transport_address":"127.0.0.1:9300","host":"127.0.0.1","ip":"127.0.0.1","version":"2.0.0","build":"de54438","http_address":"127.0.0.1:9200","os":{"refresh_interval_in_millis":1000,"name":"Mac OS X","arch":"x86_64","version":"10.10.5","available_processors":8},"jvm":{"pid":31005,"version":"1.8.0_40","vm_name":"Java HotSpot(TM) 64-Bit Server VM","vm_version":"25.40-b25","vm_vendor":"Oracle Corporation","start_time_in_millis":1446052374353,"mem":{"heap_init_in_bytes":268435456,"heap_max_in_bytes":1037959168,"non_heap_init_in_bytes":2555904,"non_heap_max_in_bytes":0,"direct_max_in_bytes":1037959168},"gc_collectors":["ParNew","ConcurrentMarkSweep"],"memory_pools":["Code Cache","Metaspace","Compressed Class Space","Par Eden Space","Par Survivor Space","CMS Old Gen"]}}}}');
  var cluster = new Cluster(health, state, indexStats, nodeStats, settings, aliases, nodes, main);

  var state2 = JSON.parse('{"cluster_name":"elasticsearch","master_node":"JABXlsAfSWmjZ1YdzFsn9A","blocks":{"indices":{"qux":{"4":{"description":"index closed","retryable":false,"levels":["read","write"]}}}},"nodes":{"JABXlsAfSWmjZ1YdzFsn9A":{"name":"Maur-Konn","transport_address":"127.0.0.1:9300","attributes":{}},"4KsHvWKoQsiwQ7MJr0CpDB":{"name":"Nosferata","transport_address":"127.0.0.1:9301","attributes":{}}},"routing_table":{"indices":{"foobar":{"shards":{"1":[{"state":"STARTED","primary":true,"node":"JABXlsAfSWmjZ1YdzFsn9A","relocating_node":null,"shard":1,"index":"foobar","version":2,"allocation_id":{"id":"iAx8JVl2QVmhc1ttLHPGQQ"}}],"0":[{"state":"STARTED","primary":true,"node":"4KsHvWKoQsiwQ7MJr0CpDB","relocating_node":null,"shard":0,"index":"foobar","version":2,"allocation_id":{"id":"TiagPPg5Qp2ksOn2zWnLTA"}}]}},"foobaz":{"shards":{"0":[{"state":"STARTED","primary":true,"node":"4KsHvWKoQsiwQ7MJr0CpDB","relocating_node":null,"shard":0,"index":"foobaz","version":3,"allocation_id":{"id":"OOFFxN-lT4OdTa9BqVA_cg"}},{"state":"STARTED","primary":false,"node":"JABXlsAfSWmjZ1YdzFsn9A","relocating_node":null,"shard":0,"index":"foobaz","version":3,"allocation_id":{"id":"FQJQZmPXQd2DaWQGxXwniw"}},{"state":"UNASSIGNED","primary":false,"node":null,"relocating_node":null,"shard":0,"index":"foobaz","version":3,"unassigned_info":{"reason":"INDEX_CREATED","at":"2015-10-28T17:14:44.477Z"}}]}}}}}');
  var indexStats2 = JSON.parse('{"_shards":{"total":5,"successful":4,"failed":0},"_all":{"primaries":{"docs":{"count":7,"deleted":0},"store":{"size_in_bytes":381,"throttle_time_in_millis":0}},"total":{"docs":{"count":7,"deleted":0},"store":{"size_in_bytes":508,"throttle_time_in_millis":0}}},"indices":{"foobar":{"primaries":{"docs":{"count":7,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0}},"total":{"docs":{"count":7,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0}}},"foobaz":{"primaries":{"docs":{"count":0,"deleted":0},"store":{"size_in_bytes":127,"throttle_time_in_millis":0}},"total":{"docs":{"count":0,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0}}}}}');
  var nodeStats2 = JSON.parse('{"cluster_name":"elasticsearch","nodes":{"4KsHvWKoQsiwQ7MJr0CpDB":{"timestamp":1446052486381,"name":"Nosferata","transport_address":"127.0.0.1:9301","host":"127.0.0.1","ip":["127.0.0.1:9301","NONE"],"indices":{"docs":{"count":2,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0},"indexing":{"index_total":2,"index_time_in_millis":55,"index_current":0,"delete_total":0,"delete_time_in_millis":0,"delete_current":0,"noop_update_total":0,"is_throttled":false,"throttle_time_in_millis":0},"get":{"total":0,"time_in_millis":0,"exists_total":0,"exists_time_in_millis":0,"missing_total":0,"missing_time_in_millis":0,"current":0},"search":{"open_contexts":0,"query_total":0,"query_time_in_millis":0,"query_current":0,"fetch_total":0,"fetch_time_in_millis":0,"fetch_current":0,"scroll_total":0,"scroll_time_in_millis":0,"scroll_current":0},"merges":{"current":0,"current_docs":0,"current_size_in_bytes":0,"total":0,"total_time_in_millis":0,"total_docs":0,"total_size_in_bytes":0,"total_stopped_time_in_millis":0,"total_throttled_time_in_millis":0,"total_auto_throttle_in_bytes":62914560},"refresh":{"total":3,"total_time_in_millis":227},"flush":{"total":0,"total_time_in_millis":0},"warmer":{"current":0,"total":6,"total_time_in_millis":27},"query_cache":{"memory_size_in_bytes":0,"total_count":0,"hit_count":0,"miss_count":0,"cache_size":0,"cache_count":0,"evictions":0},"fielddata":{"memory_size_in_bytes":0,"evictions":0},"percolate":{"total":0,"time_in_millis":0,"current":0,"memory_size_in_bytes":-1,"memory_size":"-1b","queries":0},"completion":{"size_in_bytes":0},"segments":{"count":1,"memory_in_bytes":3140,"terms_memory_in_bytes":2696,"stored_fields_memory_in_bytes":312,"term_vectors_memory_in_bytes":0,"norms_memory_in_bytes":40,"doc_values_memory_in_bytes":92,"index_writer_memory_in_bytes":0,"index_writer_max_memory_in_bytes":134217728,"version_map_memory_in_bytes":0,"fixed_bit_set_memory_in_bytes":144},"translog":{"operations":2,"size_in_bytes":242},"suggest":{"total":0,"time_in_millis":0,"current":0},"request_cache":{"memory_size_in_bytes":0,"evictions":0,"hit_count":0,"miss_count":0},"recovery":{"current_as_source":0,"current_as_target":0,"throttle_time_in_millis":0}},"os":{"timestamp":1446052486385,"load_average":3.41845703125,"mem":{"total_in_bytes":8589934592,"free_in_bytes":16728064,"used_in_bytes":8573206528,"free_percent":0,"used_percent":100},"swap":{"total_in_bytes":3221225472,"free_in_bytes":783810560,"used_in_bytes":2437414912}},"process":{"timestamp":1446052486386,"open_file_descriptors":262,"max_file_descriptors":10240,"cpu":{"percent":1,"total_in_millis":9645},"mem":{"total_virtual_in_bytes":5299920896}},"jvm":{"timestamp":1446052486386,"uptime_in_millis":29624,"mem":{"heap_used_in_bytes":71560536,"heap_used_percent":6,"heap_committed_in_bytes":259522560,"heap_max_in_bytes":1037959168,"non_heap_used_in_bytes":49027984,"non_heap_committed_in_bytes":50233344,"pools":{"young":{"used_in_bytes":54535024,"max_in_bytes":286326784,"peak_used_in_bytes":71630848,"peak_max_in_bytes":286326784},"survivor":{"used_in_bytes":8338752,"max_in_bytes":35782656,"peak_used_in_bytes":8912896,"peak_max_in_bytes":35782656},"old":{"used_in_bytes":8686760,"max_in_bytes":715849728,"peak_used_in_bytes":9538672,"peak_max_in_bytes":715849728}}},"threads":{"count":83,"peak_count":83},"gc":{"collectors":{"young":{"collection_count":4,"collection_time_in_millis":50},"old":{"collection_count":1,"collection_time_in_millis":11}}},"buffer_pools":{"direct":{"count":77,"used_in_bytes":13643902,"total_capacity_in_bytes":13643902},"mapped":{"count":0,"used_in_bytes":0,"total_capacity_in_bytes":0}}},"thread_pool":{"bulk":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_started":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_store":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"flush":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"generic":{"threads":4,"queue":0,"active":0,"rejected":0,"largest":4,"completed":63},"get":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"index":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":2},"listener":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"management":{"threads":2,"queue":0,"active":1,"rejected":0,"largest":2,"completed":20},"optimize":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"percolate":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"refresh":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":3},"search":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"snapshot":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"suggest":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"warmer":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":6}},"fs":{"timestamp":1446052486387,"total":{"total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424},"data":[{"path":"/Users/leonardo.menezes/Downloads/elastic/elasticsearch-2.0.0/data/elasticsearch/nodes/1","mount":"/ (/dev/disk1)","type":"hfs","total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424}]},"transport":{"server_open":13,"rx_count":135,"rx_size_in_bytes":20942,"tx_count":134,"tx_size_in_bytes":111876},"http":{"current_open":0,"total_opened":0},"breakers":{"request":{"limit_size_in_bytes":415183667,"limit_size":"395.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0},"fielddata":{"limit_size_in_bytes":622775500,"limit_size":"593.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.03,"tripped":0},"parent":{"limit_size_in_bytes":726571417,"limit_size":"692.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0}},"script":{"compilations":0,"cache_evictions":0}},"JABXlsAfSWmjZ1YdzFsn9A":{"timestamp":1446052486380,"name":"Maur-Konn","transport_address":"127.0.0.1:9300","host":"127.0.0.1","ip":["127.0.0.1:9300","NONE"],"indices":{"docs":{"count":5,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0},"indexing":{"index_total":6,"index_time_in_millis":84,"index_current":0,"delete_total":0,"delete_time_in_millis":0,"delete_current":0,"noop_update_total":0,"is_throttled":false,"throttle_time_in_millis":0},"get":{"total":0,"time_in_millis":0,"exists_total":0,"exists_time_in_millis":0,"missing_total":0,"missing_time_in_millis":0,"current":0},"search":{"open_contexts":0,"query_total":0,"query_time_in_millis":0,"query_current":0,"fetch_total":0,"fetch_time_in_millis":0,"fetch_current":0,"scroll_total":0,"scroll_time_in_millis":0,"scroll_current":0},"merges":{"current":0,"current_docs":0,"current_size_in_bytes":0,"total":0,"total_time_in_millis":0,"total_docs":0,"total_size_in_bytes":0,"total_stopped_time_in_millis":0,"total_throttled_time_in_millis":0,"total_auto_throttle_in_bytes":62914560},"refresh":{"total":2,"total_time_in_millis":110},"flush":{"total":0,"total_time_in_millis":0},"warmer":{"current":0,"total":7,"total_time_in_millis":40},"query_cache":{"memory_size_in_bytes":0,"total_count":0,"hit_count":0,"miss_count":0,"cache_size":0,"cache_count":0,"evictions":0},"fielddata":{"memory_size_in_bytes":0,"evictions":0},"percolate":{"total":0,"time_in_millis":0,"current":0,"memory_size_in_bytes":-1,"memory_size":"-1b","queries":0},"completion":{"size_in_bytes":0},"segments":{"count":1,"memory_in_bytes":3140,"terms_memory_in_bytes":2696,"stored_fields_memory_in_bytes":312,"term_vectors_memory_in_bytes":0,"norms_memory_in_bytes":40,"doc_values_memory_in_bytes":92,"index_writer_memory_in_bytes":0,"index_writer_max_memory_in_bytes":134217728,"version_map_memory_in_bytes":0,"fixed_bit_set_memory_in_bytes":72},"translog":{"operations":6,"size_in_bytes":554},"suggest":{"total":0,"time_in_millis":0,"current":0},"request_cache":{"memory_size_in_bytes":0,"evictions":0,"hit_count":0,"miss_count":0},"recovery":{"current_as_source":0,"current_as_target":0,"throttle_time_in_millis":0}},"os":{"timestamp":1446052486385,"load_average":3.41845703125,"mem":{"total_in_bytes":8589934592,"free_in_bytes":16728064,"used_in_bytes":8573206528,"free_percent":0,"used_percent":100},"swap":{"total_in_bytes":3221225472,"free_in_bytes":783810560,"used_in_bytes":2437414912}},"process":{"timestamp":1446052486385,"open_file_descriptors":269,"max_file_descriptors":10240,"cpu":{"percent":2,"total_in_millis":11995},"mem":{"total_virtual_in_bytes":5296005120}},"jvm":{"timestamp":1446052486385,"uptime_in_millis":112118,"mem":{"heap_used_in_bytes":39629216,"heap_used_percent":3,"heap_committed_in_bytes":259522560,"heap_max_in_bytes":1037959168,"non_heap_used_in_bytes":52022368,"non_heap_committed_in_bytes":52817920,"pools":{"young":{"used_in_bytes":18641688,"max_in_bytes":286326784,"peak_used_in_bytes":71630848,"peak_max_in_bytes":286326784},"survivor":{"used_in_bytes":8713504,"max_in_bytes":35782656,"peak_used_in_bytes":8912888,"peak_max_in_bytes":35782656},"old":{"used_in_bytes":12274024,"max_in_bytes":715849728,"peak_used_in_bytes":12274024,"peak_max_in_bytes":715849728}}},"threads":{"count":79,"peak_count":80},"gc":{"collectors":{"young":{"collection_count":5,"collection_time_in_millis":60},"old":{"collection_count":1,"collection_time_in_millis":16}}},"buffer_pools":{"direct":{"count":131,"used_in_bytes":22063045,"total_capacity_in_bytes":22063045},"mapped":{"count":0,"used_in_bytes":0,"total_capacity_in_bytes":0}},"classes":{"current_loaded_count":7343,"total_loaded_count":7343,"total_unloaded_count":0}},"thread_pool":{"bulk":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_started":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_store":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"flush":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"generic":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":4,"completed":56},"get":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"index":{"threads":6,"queue":0,"active":0,"rejected":0,"largest":6,"completed":6},"listener":{"threads":4,"queue":0,"active":0,"rejected":0,"largest":4,"completed":161},"management":{"threads":2,"queue":0,"active":1,"rejected":0,"largest":2,"completed":88},"optimize":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"percolate":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"refresh":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":2},"search":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"snapshot":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"suggest":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"warmer":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":6}},"fs":{"timestamp":1446052486386,"total":{"total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424},"data":[{"path":"/Users/leonardo.menezes/Downloads/elastic/elasticsearch-2.0.0/data/elasticsearch/nodes/0","mount":"/ (/dev/disk1)","type":"hfs","total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424}]},"transport":{"server_open":13,"rx_count":134,"rx_size_in_bytes":111876,"tx_count":135,"tx_size_in_bytes":20942},"http":{"current_open":7,"total_opened":29},"breakers":{"request":{"limit_size_in_bytes":415183667,"limit_size":"395.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0},"fielddata":{"limit_size_in_bytes":622775500,"limit_size":"593.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.03,"tripped":0},"parent":{"limit_size_in_bytes":726571417,"limit_size":"692.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0}},"script":{"compilations":0,"cache_evictions":0}}}}');
  var settings2 = JSON.parse('{"foobar":{"settings":{"index":{"creation_date":"1446052483693","analysis":{"analyzer":{"index_inc_search":{"filter":["lowercase"],"tokenizer":"whitespace"}}},"number_of_shards":"2","number_of_replicas":"0","uuid":"BzQapH-qT8GWdrOCm-mFKg","version":{"created":"2000099"}}}},"foobaz":{"settings":{"index":{"creation_date":"1446052484466","analysis":{"analyzer":{"index_inc_search":{"filter":["lowercase"],"tokenizer":"whitespace"}}},"number_of_shards":"1","number_of_replicas":"2","uuid":"mPg_arqrREiXzhnhi0w6jg","version":{"created":"2000099"}}}}}');
  var aliases2 = JSON.parse('{"foobar":{"aliases":{}},"foobaz":{"aliases":{}}}');
  var health2 = JSON.parse('{"cluster_name":"elasticsearch","status":"yellow","timed_out":false,"number_of_nodes":2,"number_of_data_nodes":2,"active_primary_shards":3,"active_shards":4,"relocating_shards":0,"initializing_shards":0,"unassigned_shards":1,"delayed_unassigned_shards":0,"number_of_pending_tasks":0,"number_of_in_flight_fetch":0,"task_max_waiting_in_queue_millis":0,"active_shards_percent_as_number":80.0}');
  var nodes2 = JSON.parse('{"cluster_name":"elasticsearch","nodes":{"4KsHvWKoQsiwQ7MJr0CpDB":{"name":"Nosferata","transport_address":"127.0.0.1:9301","host":"127.0.0.1","ip":"127.0.0.1","version":"2.0.0","build":"de54438","http_address":"127.0.0.1:9201","os":{"refresh_interval_in_millis":1000,"available_processors":8},"jvm":{"pid":31338,"version":"1.8.0_40","vm_name":"Java HotSpot(TM) 64-Bit Server VM","vm_version":"25.40-b25","vm_vendor":"Oracle Corporation","start_time_in_millis":1446052456821,"mem":{"heap_init_in_bytes":268435456,"heap_max_in_bytes":1037959168,"non_heap_init_in_bytes":2555904,"non_heap_max_in_bytes":0,"direct_max_in_bytes":1037959168},"gc_collectors":["ParNew","ConcurrentMarkSweep"],"memory_pools":["Code Cache","Metaspace","Compressed Class Space","Par Eden Space","Par Survivor Space","CMS Old Gen"]}},"JABXlsAfSWmjZ1YdzFsn9A":{"name":"Maur-Konn","transport_address":"127.0.0.1:9300","host":"127.0.0.1","ip":"127.0.0.1","version":"2.0.0","build":"de54438","http_address":"127.0.0.1:9200","os":{"refresh_interval_in_millis":1000,"name":"Mac OS X","arch":"x86_64","version":"10.10.5","available_processors":8},"jvm":{"pid":31005,"version":"1.8.0_40","vm_name":"Java HotSpot(TM) 64-Bit Server VM","vm_version":"25.40-b25","vm_vendor":"Oracle Corporation","start_time_in_millis":1446052374353,"mem":{"heap_init_in_bytes":268435456,"heap_max_in_bytes":1037959168,"non_heap_init_in_bytes":2555904,"non_heap_max_in_bytes":0,"direct_max_in_bytes":1037959168},"gc_collectors":["ParNew","ConcurrentMarkSweep"],"memory_pools":["Code Cache","Metaspace","Compressed Class Space","Par Eden Space","Par Survivor Space","CMS Old Gen"]}}}}');
  var cluster2 = new Cluster(health2, state2, indexStats2, nodeStats2, settings2, aliases2, nodes2, main);

  cluster2.computeChanges(cluster);

  ok(cluster2.changes.getDocDelta() == -1, "Checking document delta ");
  ok(cluster2.changes.getDataDelta() == 100,
      "" + cluster2.changes.getDataDelta());
  ok(cluster2.changes.absDataDelta() == "100.00b",
      "" + cluster2.changes.absDataDelta());

  ok(cluster2.changes.nodeJoins.length == 1, "checking joinng nodes");
  ok(cluster2.changes.nodeLeaves.length == 1, "checking disconnecting nodes");

  ok(cluster2.changes.nodeJoins[0].id == "4KsHvWKoQsiwQ7MJr0CpDB",
      "checking node identity");
  ok(cluster2.changes.nodeLeaves[0].id == "4KsHvWKoQsiwQ7MJr0CpDA",
      "checking node identity");
});

test("computing cluster changes on two different clusters should yield no changes",
    function() {
      var state = JSON.parse('{"cluster_name":"elasticsearch","master_node":"JABXlsAfSWmjZ1YdzFsn9A","blocks":{"indices":{"qux":{"4":{"description":"index closed","retryable":false,"levels":["read","write"]}}}},"nodes":{"JABXlsAfSWmjZ1YdzFsn9A":{"name":"Maur-Konn","transport_address":"127.0.0.1:9300","attributes":{}},"4KsHvWKoQsiwQ7MJr0CpDA":{"name":"Nosferata","transport_address":"127.0.0.1:9301","attributes":{}}},"routing_table":{"indices":{"foobar":{"shards":{"1":[{"state":"STARTED","primary":true,"node":"JABXlsAfSWmjZ1YdzFsn9A","relocating_node":null,"shard":1,"index":"foobar","version":2,"allocation_id":{"id":"iAx8JVl2QVmhc1ttLHPGQQ"}}],"0":[{"state":"STARTED","primary":true,"node":"4KsHvWKoQsiwQ7MJr0CpDA","relocating_node":null,"shard":0,"index":"foobar","version":2,"allocation_id":{"id":"TiagPPg5Qp2ksOn2zWnLTA"}}]}},"foobaz":{"shards":{"0":[{"state":"STARTED","primary":true,"node":"4KsHvWKoQsiwQ7MJr0CpDA","relocating_node":null,"shard":0,"index":"foobaz","version":3,"allocation_id":{"id":"OOFFxN-lT4OdTa9BqVA_cg"}},{"state":"STARTED","primary":false,"node":"JABXlsAfSWmjZ1YdzFsn9A","relocating_node":null,"shard":0,"index":"foobaz","version":3,"allocation_id":{"id":"FQJQZmPXQd2DaWQGxXwniw"}},{"state":"UNASSIGNED","primary":false,"node":null,"relocating_node":null,"shard":0,"index":"foobaz","version":3,"unassigned_info":{"reason":"INDEX_CREATED","at":"2015-10-28T17:14:44.477Z"}}]}}}}}');
      var indexStats = JSON.parse('{"_shards":{"total":5,"successful":4,"failed":0},"_all":{"primaries":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":381,"throttle_time_in_millis":0}},"total":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":508,"throttle_time_in_millis":0}}},"indices":{"foobar":{"primaries":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0}},"total":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0}}},"foobaz":{"primaries":{"docs":{"count":0,"deleted":0},"store":{"size_in_bytes":127,"throttle_time_in_millis":0}},"total":{"docs":{"count":0,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0}}}}}');
      var nodeStats = JSON.parse('{"cluster_name":"elasticsearch","nodes":{"4KsHvWKoQsiwQ7MJr0CpDA":{"timestamp":1446052486381,"name":"Nosferata","transport_address":"127.0.0.1:9301","host":"127.0.0.1","ip":["127.0.0.1:9301","NONE"],"indices":{"docs":{"count":2,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0},"indexing":{"index_total":2,"index_time_in_millis":55,"index_current":0,"delete_total":0,"delete_time_in_millis":0,"delete_current":0,"noop_update_total":0,"is_throttled":false,"throttle_time_in_millis":0},"get":{"total":0,"time_in_millis":0,"exists_total":0,"exists_time_in_millis":0,"missing_total":0,"missing_time_in_millis":0,"current":0},"search":{"open_contexts":0,"query_total":0,"query_time_in_millis":0,"query_current":0,"fetch_total":0,"fetch_time_in_millis":0,"fetch_current":0,"scroll_total":0,"scroll_time_in_millis":0,"scroll_current":0},"merges":{"current":0,"current_docs":0,"current_size_in_bytes":0,"total":0,"total_time_in_millis":0,"total_docs":0,"total_size_in_bytes":0,"total_stopped_time_in_millis":0,"total_throttled_time_in_millis":0,"total_auto_throttle_in_bytes":62914560},"refresh":{"total":3,"total_time_in_millis":227},"flush":{"total":0,"total_time_in_millis":0},"warmer":{"current":0,"total":6,"total_time_in_millis":27},"query_cache":{"memory_size_in_bytes":0,"total_count":0,"hit_count":0,"miss_count":0,"cache_size":0,"cache_count":0,"evictions":0},"fielddata":{"memory_size_in_bytes":0,"evictions":0},"percolate":{"total":0,"time_in_millis":0,"current":0,"memory_size_in_bytes":-1,"memory_size":"-1b","queries":0},"completion":{"size_in_bytes":0},"segments":{"count":1,"memory_in_bytes":3140,"terms_memory_in_bytes":2696,"stored_fields_memory_in_bytes":312,"term_vectors_memory_in_bytes":0,"norms_memory_in_bytes":40,"doc_values_memory_in_bytes":92,"index_writer_memory_in_bytes":0,"index_writer_max_memory_in_bytes":134217728,"version_map_memory_in_bytes":0,"fixed_bit_set_memory_in_bytes":144},"translog":{"operations":2,"size_in_bytes":242},"suggest":{"total":0,"time_in_millis":0,"current":0},"request_cache":{"memory_size_in_bytes":0,"evictions":0,"hit_count":0,"miss_count":0},"recovery":{"current_as_source":0,"current_as_target":0,"throttle_time_in_millis":0}},"os":{"timestamp":1446052486385,"load_average":3.41845703125,"mem":{"total_in_bytes":8589934592,"free_in_bytes":16728064,"used_in_bytes":8573206528,"free_percent":0,"used_percent":100},"swap":{"total_in_bytes":3221225472,"free_in_bytes":783810560,"used_in_bytes":2437414912}},"process":{"timestamp":1446052486386,"open_file_descriptors":262,"max_file_descriptors":10240,"cpu":{"percent":1,"total_in_millis":9645},"mem":{"total_virtual_in_bytes":5299920896}},"jvm":{"timestamp":1446052486386,"uptime_in_millis":29624,"mem":{"heap_used_in_bytes":71560536,"heap_used_percent":6,"heap_committed_in_bytes":259522560,"heap_max_in_bytes":1037959168,"non_heap_used_in_bytes":49027984,"non_heap_committed_in_bytes":50233344,"pools":{"young":{"used_in_bytes":54535024,"max_in_bytes":286326784,"peak_used_in_bytes":71630848,"peak_max_in_bytes":286326784},"survivor":{"used_in_bytes":8338752,"max_in_bytes":35782656,"peak_used_in_bytes":8912896,"peak_max_in_bytes":35782656},"old":{"used_in_bytes":8686760,"max_in_bytes":715849728,"peak_used_in_bytes":9538672,"peak_max_in_bytes":715849728}}},"threads":{"count":83,"peak_count":83},"gc":{"collectors":{"young":{"collection_count":4,"collection_time_in_millis":50},"old":{"collection_count":1,"collection_time_in_millis":11}}},"buffer_pools":{"direct":{"count":77,"used_in_bytes":13643902,"total_capacity_in_bytes":13643902},"mapped":{"count":0,"used_in_bytes":0,"total_capacity_in_bytes":0}}},"thread_pool":{"bulk":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_started":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_store":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"flush":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"generic":{"threads":4,"queue":0,"active":0,"rejected":0,"largest":4,"completed":63},"get":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"index":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":2},"listener":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"management":{"threads":2,"queue":0,"active":1,"rejected":0,"largest":2,"completed":20},"optimize":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"percolate":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"refresh":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":3},"search":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"snapshot":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"suggest":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"warmer":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":6}},"fs":{"timestamp":1446052486387,"total":{"total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424},"data":[{"path":"/Users/leonardo.menezes/Downloads/elastic/elasticsearch-2.0.0/data/elasticsearch/nodes/1","mount":"/ (/dev/disk1)","type":"hfs","total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424}]},"transport":{"server_open":13,"rx_count":135,"rx_size_in_bytes":20942,"tx_count":134,"tx_size_in_bytes":111876},"http":{"current_open":0,"total_opened":0},"breakers":{"request":{"limit_size_in_bytes":415183667,"limit_size":"395.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0},"fielddata":{"limit_size_in_bytes":622775500,"limit_size":"593.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.03,"tripped":0},"parent":{"limit_size_in_bytes":726571417,"limit_size":"692.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0}},"script":{"compilations":0,"cache_evictions":0}},"JABXlsAfSWmjZ1YdzFsn9A":{"timestamp":1446052486380,"name":"Maur-Konn","transport_address":"127.0.0.1:9300","host":"127.0.0.1","ip":["127.0.0.1:9300","NONE"],"indices":{"docs":{"count":6,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0},"indexing":{"index_total":6,"index_time_in_millis":84,"index_current":0,"delete_total":0,"delete_time_in_millis":0,"delete_current":0,"noop_update_total":0,"is_throttled":false,"throttle_time_in_millis":0},"get":{"total":0,"time_in_millis":0,"exists_total":0,"exists_time_in_millis":0,"missing_total":0,"missing_time_in_millis":0,"current":0},"search":{"open_contexts":0,"query_total":0,"query_time_in_millis":0,"query_current":0,"fetch_total":0,"fetch_time_in_millis":0,"fetch_current":0,"scroll_total":0,"scroll_time_in_millis":0,"scroll_current":0},"merges":{"current":0,"current_docs":0,"current_size_in_bytes":0,"total":0,"total_time_in_millis":0,"total_docs":0,"total_size_in_bytes":0,"total_stopped_time_in_millis":0,"total_throttled_time_in_millis":0,"total_auto_throttle_in_bytes":62914560},"refresh":{"total":2,"total_time_in_millis":110},"flush":{"total":0,"total_time_in_millis":0},"warmer":{"current":0,"total":7,"total_time_in_millis":40},"query_cache":{"memory_size_in_bytes":0,"total_count":0,"hit_count":0,"miss_count":0,"cache_size":0,"cache_count":0,"evictions":0},"fielddata":{"memory_size_in_bytes":0,"evictions":0},"percolate":{"total":0,"time_in_millis":0,"current":0,"memory_size_in_bytes":-1,"memory_size":"-1b","queries":0},"completion":{"size_in_bytes":0},"segments":{"count":1,"memory_in_bytes":3140,"terms_memory_in_bytes":2696,"stored_fields_memory_in_bytes":312,"term_vectors_memory_in_bytes":0,"norms_memory_in_bytes":40,"doc_values_memory_in_bytes":92,"index_writer_memory_in_bytes":0,"index_writer_max_memory_in_bytes":134217728,"version_map_memory_in_bytes":0,"fixed_bit_set_memory_in_bytes":72},"translog":{"operations":6,"size_in_bytes":554},"suggest":{"total":0,"time_in_millis":0,"current":0},"request_cache":{"memory_size_in_bytes":0,"evictions":0,"hit_count":0,"miss_count":0},"recovery":{"current_as_source":0,"current_as_target":0,"throttle_time_in_millis":0}},"os":{"timestamp":1446052486385,"load_average":3.41845703125,"mem":{"total_in_bytes":8589934592,"free_in_bytes":16728064,"used_in_bytes":8573206528,"free_percent":0,"used_percent":100},"swap":{"total_in_bytes":3221225472,"free_in_bytes":783810560,"used_in_bytes":2437414912}},"process":{"timestamp":1446052486385,"open_file_descriptors":269,"max_file_descriptors":10240,"cpu":{"percent":2,"total_in_millis":11995},"mem":{"total_virtual_in_bytes":5296005120}},"jvm":{"timestamp":1446052486385,"uptime_in_millis":112118,"mem":{"heap_used_in_bytes":39629216,"heap_used_percent":3,"heap_committed_in_bytes":259522560,"heap_max_in_bytes":1037959168,"non_heap_used_in_bytes":52022368,"non_heap_committed_in_bytes":52817920,"pools":{"young":{"used_in_bytes":18641688,"max_in_bytes":286326784,"peak_used_in_bytes":71630848,"peak_max_in_bytes":286326784},"survivor":{"used_in_bytes":8713504,"max_in_bytes":35782656,"peak_used_in_bytes":8912888,"peak_max_in_bytes":35782656},"old":{"used_in_bytes":12274024,"max_in_bytes":715849728,"peak_used_in_bytes":12274024,"peak_max_in_bytes":715849728}}},"threads":{"count":79,"peak_count":80},"gc":{"collectors":{"young":{"collection_count":5,"collection_time_in_millis":60},"old":{"collection_count":1,"collection_time_in_millis":16}}},"buffer_pools":{"direct":{"count":131,"used_in_bytes":22063045,"total_capacity_in_bytes":22063045},"mapped":{"count":0,"used_in_bytes":0,"total_capacity_in_bytes":0}},"classes":{"current_loaded_count":7343,"total_loaded_count":7343,"total_unloaded_count":0}},"thread_pool":{"bulk":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_started":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_store":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"flush":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"generic":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":4,"completed":56},"get":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"index":{"threads":6,"queue":0,"active":0,"rejected":0,"largest":6,"completed":6},"listener":{"threads":4,"queue":0,"active":0,"rejected":0,"largest":4,"completed":161},"management":{"threads":2,"queue":0,"active":1,"rejected":0,"largest":2,"completed":88},"optimize":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"percolate":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"refresh":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":2},"search":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"snapshot":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"suggest":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"warmer":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":6}},"fs":{"timestamp":1446052486386,"total":{"total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424},"data":[{"path":"/Users/leonardo.menezes/Downloads/elastic/elasticsearch-2.0.0/data/elasticsearch/nodes/0","mount":"/ (/dev/disk1)","type":"hfs","total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424}]},"transport":{"server_open":13,"rx_count":134,"rx_size_in_bytes":111876,"tx_count":135,"tx_size_in_bytes":20942},"http":{"current_open":7,"total_opened":29},"breakers":{"request":{"limit_size_in_bytes":415183667,"limit_size":"395.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0},"fielddata":{"limit_size_in_bytes":622775500,"limit_size":"593.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.03,"tripped":0},"parent":{"limit_size_in_bytes":726571417,"limit_size":"692.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0}},"script":{"compilations":0,"cache_evictions":0}}}}');
      var settings = JSON.parse('{"foobar":{"settings":{"index":{"creation_date":"1446052483693","analysis":{"analyzer":{"index_inc_search":{"filter":["lowercase"],"tokenizer":"whitespace"}}},"number_of_shards":"2","number_of_replicas":"0","uuid":"BzQapH-qT8GWdrOCm-mFKg","version":{"created":"2000099"}}}},"foobaz":{"settings":{"index":{"creation_date":"1446052484466","analysis":{"analyzer":{"index_inc_search":{"filter":["lowercase"],"tokenizer":"whitespace"}}},"number_of_shards":"1","number_of_replicas":"2","uuid":"mPg_arqrREiXzhnhi0w6jg","version":{"created":"2000099"}}}}}');
      var aliases = JSON.parse('{"foobar":{"aliases":{}},"foobaz":{"aliases":{}}}');
      var health = JSON.parse('{"cluster_name":"elasticsearch","status":"yellow","timed_out":false,"number_of_nodes":2,"number_of_data_nodes":2,"active_primary_shards":3,"active_shards":4,"relocating_shards":0,"initializing_shards":0,"unassigned_shards":1,"delayed_unassigned_shards":0,"number_of_pending_tasks":0,"number_of_in_flight_fetch":0,"task_max_waiting_in_queue_millis":0,"active_shards_percent_as_number":80.0}');
      var nodes = JSON.parse('{"cluster_name":"elasticsearch","nodes":{"4KsHvWKoQsiwQ7MJr0CpDA":{"name":"Nosferata","transport_address":"127.0.0.1:9301","host":"127.0.0.1","ip":"127.0.0.1","version":"2.0.0","build":"de54438","http_address":"127.0.0.1:9201","os":{"refresh_interval_in_millis":1000,"available_processors":8},"jvm":{"pid":31338,"version":"1.8.0_40","vm_name":"Java HotSpot(TM) 64-Bit Server VM","vm_version":"25.40-b25","vm_vendor":"Oracle Corporation","start_time_in_millis":1446052456821,"mem":{"heap_init_in_bytes":268435456,"heap_max_in_bytes":1037959168,"non_heap_init_in_bytes":2555904,"non_heap_max_in_bytes":0,"direct_max_in_bytes":1037959168},"gc_collectors":["ParNew","ConcurrentMarkSweep"],"memory_pools":["Code Cache","Metaspace","Compressed Class Space","Par Eden Space","Par Survivor Space","CMS Old Gen"]}},"JABXlsAfSWmjZ1YdzFsn9A":{"name":"Maur-Konn","transport_address":"127.0.0.1:9300","host":"127.0.0.1","ip":"127.0.0.1","version":"2.0.0","build":"de54438","http_address":"127.0.0.1:9200","os":{"refresh_interval_in_millis":1000,"name":"Mac OS X","arch":"x86_64","version":"10.10.5","available_processors":8},"jvm":{"pid":31005,"version":"1.8.0_40","vm_name":"Java HotSpot(TM) 64-Bit Server VM","vm_version":"25.40-b25","vm_vendor":"Oracle Corporation","start_time_in_millis":1446052374353,"mem":{"heap_init_in_bytes":268435456,"heap_max_in_bytes":1037959168,"non_heap_init_in_bytes":2555904,"non_heap_max_in_bytes":0,"direct_max_in_bytes":1037959168},"gc_collectors":["ParNew","ConcurrentMarkSweep"],"memory_pools":["Code Cache","Metaspace","Compressed Class Space","Par Eden Space","Par Survivor Space","CMS Old Gen"]}}}}');
      var cluster = new Cluster(health, state, indexStats, nodeStats, settings, aliases, nodes, main);

      var state2 = JSON.parse('{"cluster_name":"elasticsearch2","master_node":"JABXlsAfSWmjZ1YdzFsn9A","blocks":{"indices":{"qux":{"4":{"description":"index closed","retryable":false,"levels":["read","write"]}}}},"nodes":{"JABXlsAfSWmjZ1YdzFsn9A":{"name":"Maur-Konn","transport_address":"127.0.0.1:9300","attributes":{}},"4KsHvWKoQsiwQ7MJr0CpDA":{"name":"Nosferata","transport_address":"127.0.0.1:9301","attributes":{}}},"routing_table":{"indices":{"foobar":{"shards":{"1":[{"state":"STARTED","primary":true,"node":"JABXlsAfSWmjZ1YdzFsn9A","relocating_node":null,"shard":1,"index":"foobar","version":2,"allocation_id":{"id":"iAx8JVl2QVmhc1ttLHPGQQ"}}],"0":[{"state":"STARTED","primary":true,"node":"4KsHvWKoQsiwQ7MJr0CpDA","relocating_node":null,"shard":0,"index":"foobar","version":2,"allocation_id":{"id":"TiagPPg5Qp2ksOn2zWnLTA"}}]}},"foobaz":{"shards":{"0":[{"state":"STARTED","primary":true,"node":"4KsHvWKoQsiwQ7MJr0CpDA","relocating_node":null,"shard":0,"index":"foobaz","version":3,"allocation_id":{"id":"OOFFxN-lT4OdTa9BqVA_cg"}},{"state":"STARTED","primary":false,"node":"JABXlsAfSWmjZ1YdzFsn9A","relocating_node":null,"shard":0,"index":"foobaz","version":3,"allocation_id":{"id":"FQJQZmPXQd2DaWQGxXwniw"}},{"state":"UNASSIGNED","primary":false,"node":null,"relocating_node":null,"shard":0,"index":"foobaz","version":3,"unassigned_info":{"reason":"INDEX_CREATED","at":"2015-10-28T17:14:44.477Z"}}]}}}}}');
      var indexStats2 = JSON.parse('{"_shards":{"total":5,"successful":4,"failed":0},"_all":{"primaries":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":381,"throttle_time_in_millis":0}},"total":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":508,"throttle_time_in_millis":0}}},"indices":{"foobar":{"primaries":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0}},"total":{"docs":{"count":8,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0}}},"foobaz":{"primaries":{"docs":{"count":0,"deleted":0},"store":{"size_in_bytes":127,"throttle_time_in_millis":0}},"total":{"docs":{"count":0,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0}}}}}');
      var nodeStats2 = JSON.parse('{"cluster_name":"elasticsearch","nodes":{"4KsHvWKoQsiwQ7MJr0CpDA":{"timestamp":1446052486381,"name":"Nosferata","transport_address":"127.0.0.1:9301","host":"127.0.0.1","ip":["127.0.0.1:9301","NONE"],"indices":{"docs":{"count":2,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0},"indexing":{"index_total":2,"index_time_in_millis":55,"index_current":0,"delete_total":0,"delete_time_in_millis":0,"delete_current":0,"noop_update_total":0,"is_throttled":false,"throttle_time_in_millis":0},"get":{"total":0,"time_in_millis":0,"exists_total":0,"exists_time_in_millis":0,"missing_total":0,"missing_time_in_millis":0,"current":0},"search":{"open_contexts":0,"query_total":0,"query_time_in_millis":0,"query_current":0,"fetch_total":0,"fetch_time_in_millis":0,"fetch_current":0,"scroll_total":0,"scroll_time_in_millis":0,"scroll_current":0},"merges":{"current":0,"current_docs":0,"current_size_in_bytes":0,"total":0,"total_time_in_millis":0,"total_docs":0,"total_size_in_bytes":0,"total_stopped_time_in_millis":0,"total_throttled_time_in_millis":0,"total_auto_throttle_in_bytes":62914560},"refresh":{"total":3,"total_time_in_millis":227},"flush":{"total":0,"total_time_in_millis":0},"warmer":{"current":0,"total":6,"total_time_in_millis":27},"query_cache":{"memory_size_in_bytes":0,"total_count":0,"hit_count":0,"miss_count":0,"cache_size":0,"cache_count":0,"evictions":0},"fielddata":{"memory_size_in_bytes":0,"evictions":0},"percolate":{"total":0,"time_in_millis":0,"current":0,"memory_size_in_bytes":-1,"memory_size":"-1b","queries":0},"completion":{"size_in_bytes":0},"segments":{"count":1,"memory_in_bytes":3140,"terms_memory_in_bytes":2696,"stored_fields_memory_in_bytes":312,"term_vectors_memory_in_bytes":0,"norms_memory_in_bytes":40,"doc_values_memory_in_bytes":92,"index_writer_memory_in_bytes":0,"index_writer_max_memory_in_bytes":134217728,"version_map_memory_in_bytes":0,"fixed_bit_set_memory_in_bytes":144},"translog":{"operations":2,"size_in_bytes":242},"suggest":{"total":0,"time_in_millis":0,"current":0},"request_cache":{"memory_size_in_bytes":0,"evictions":0,"hit_count":0,"miss_count":0},"recovery":{"current_as_source":0,"current_as_target":0,"throttle_time_in_millis":0}},"os":{"timestamp":1446052486385,"load_average":3.41845703125,"mem":{"total_in_bytes":8589934592,"free_in_bytes":16728064,"used_in_bytes":8573206528,"free_percent":0,"used_percent":100},"swap":{"total_in_bytes":3221225472,"free_in_bytes":783810560,"used_in_bytes":2437414912}},"process":{"timestamp":1446052486386,"open_file_descriptors":262,"max_file_descriptors":10240,"cpu":{"percent":1,"total_in_millis":9645},"mem":{"total_virtual_in_bytes":5299920896}},"jvm":{"timestamp":1446052486386,"uptime_in_millis":29624,"mem":{"heap_used_in_bytes":71560536,"heap_used_percent":6,"heap_committed_in_bytes":259522560,"heap_max_in_bytes":1037959168,"non_heap_used_in_bytes":49027984,"non_heap_committed_in_bytes":50233344,"pools":{"young":{"used_in_bytes":54535024,"max_in_bytes":286326784,"peak_used_in_bytes":71630848,"peak_max_in_bytes":286326784},"survivor":{"used_in_bytes":8338752,"max_in_bytes":35782656,"peak_used_in_bytes":8912896,"peak_max_in_bytes":35782656},"old":{"used_in_bytes":8686760,"max_in_bytes":715849728,"peak_used_in_bytes":9538672,"peak_max_in_bytes":715849728}}},"threads":{"count":83,"peak_count":83},"gc":{"collectors":{"young":{"collection_count":4,"collection_time_in_millis":50},"old":{"collection_count":1,"collection_time_in_millis":11}}},"buffer_pools":{"direct":{"count":77,"used_in_bytes":13643902,"total_capacity_in_bytes":13643902},"mapped":{"count":0,"used_in_bytes":0,"total_capacity_in_bytes":0}}},"thread_pool":{"bulk":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_started":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_store":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"flush":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"generic":{"threads":4,"queue":0,"active":0,"rejected":0,"largest":4,"completed":63},"get":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"index":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":2},"listener":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"management":{"threads":2,"queue":0,"active":1,"rejected":0,"largest":2,"completed":20},"optimize":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"percolate":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"refresh":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":3},"search":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"snapshot":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"suggest":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"warmer":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":6}},"fs":{"timestamp":1446052486387,"total":{"total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424},"data":[{"path":"/Users/leonardo.menezes/Downloads/elastic/elasticsearch-2.0.0/data/elasticsearch/nodes/1","mount":"/ (/dev/disk1)","type":"hfs","total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424}]},"transport":{"server_open":13,"rx_count":135,"rx_size_in_bytes":20942,"tx_count":134,"tx_size_in_bytes":111876},"http":{"current_open":0,"total_opened":0},"breakers":{"request":{"limit_size_in_bytes":415183667,"limit_size":"395.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0},"fielddata":{"limit_size_in_bytes":622775500,"limit_size":"593.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.03,"tripped":0},"parent":{"limit_size_in_bytes":726571417,"limit_size":"692.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0}},"script":{"compilations":0,"cache_evictions":0}},"JABXlsAfSWmjZ1YdzFsn9A":{"timestamp":1446052486380,"name":"Maur-Konn","transport_address":"127.0.0.1:9300","host":"127.0.0.1","ip":["127.0.0.1:9300","NONE"],"indices":{"docs":{"count":6,"deleted":0},"store":{"size_in_bytes":254,"throttle_time_in_millis":0},"indexing":{"index_total":6,"index_time_in_millis":84,"index_current":0,"delete_total":0,"delete_time_in_millis":0,"delete_current":0,"noop_update_total":0,"is_throttled":false,"throttle_time_in_millis":0},"get":{"total":0,"time_in_millis":0,"exists_total":0,"exists_time_in_millis":0,"missing_total":0,"missing_time_in_millis":0,"current":0},"search":{"open_contexts":0,"query_total":0,"query_time_in_millis":0,"query_current":0,"fetch_total":0,"fetch_time_in_millis":0,"fetch_current":0,"scroll_total":0,"scroll_time_in_millis":0,"scroll_current":0},"merges":{"current":0,"current_docs":0,"current_size_in_bytes":0,"total":0,"total_time_in_millis":0,"total_docs":0,"total_size_in_bytes":0,"total_stopped_time_in_millis":0,"total_throttled_time_in_millis":0,"total_auto_throttle_in_bytes":62914560},"refresh":{"total":2,"total_time_in_millis":110},"flush":{"total":0,"total_time_in_millis":0},"warmer":{"current":0,"total":7,"total_time_in_millis":40},"query_cache":{"memory_size_in_bytes":0,"total_count":0,"hit_count":0,"miss_count":0,"cache_size":0,"cache_count":0,"evictions":0},"fielddata":{"memory_size_in_bytes":0,"evictions":0},"percolate":{"total":0,"time_in_millis":0,"current":0,"memory_size_in_bytes":-1,"memory_size":"-1b","queries":0},"completion":{"size_in_bytes":0},"segments":{"count":1,"memory_in_bytes":3140,"terms_memory_in_bytes":2696,"stored_fields_memory_in_bytes":312,"term_vectors_memory_in_bytes":0,"norms_memory_in_bytes":40,"doc_values_memory_in_bytes":92,"index_writer_memory_in_bytes":0,"index_writer_max_memory_in_bytes":134217728,"version_map_memory_in_bytes":0,"fixed_bit_set_memory_in_bytes":72},"translog":{"operations":6,"size_in_bytes":554},"suggest":{"total":0,"time_in_millis":0,"current":0},"request_cache":{"memory_size_in_bytes":0,"evictions":0,"hit_count":0,"miss_count":0},"recovery":{"current_as_source":0,"current_as_target":0,"throttle_time_in_millis":0}},"os":{"timestamp":1446052486385,"load_average":3.41845703125,"mem":{"total_in_bytes":8589934592,"free_in_bytes":16728064,"used_in_bytes":8573206528,"free_percent":0,"used_percent":100},"swap":{"total_in_bytes":3221225472,"free_in_bytes":783810560,"used_in_bytes":2437414912}},"process":{"timestamp":1446052486385,"open_file_descriptors":269,"max_file_descriptors":10240,"cpu":{"percent":2,"total_in_millis":11995},"mem":{"total_virtual_in_bytes":5296005120}},"jvm":{"timestamp":1446052486385,"uptime_in_millis":112118,"mem":{"heap_used_in_bytes":39629216,"heap_used_percent":3,"heap_committed_in_bytes":259522560,"heap_max_in_bytes":1037959168,"non_heap_used_in_bytes":52022368,"non_heap_committed_in_bytes":52817920,"pools":{"young":{"used_in_bytes":18641688,"max_in_bytes":286326784,"peak_used_in_bytes":71630848,"peak_max_in_bytes":286326784},"survivor":{"used_in_bytes":8713504,"max_in_bytes":35782656,"peak_used_in_bytes":8912888,"peak_max_in_bytes":35782656},"old":{"used_in_bytes":12274024,"max_in_bytes":715849728,"peak_used_in_bytes":12274024,"peak_max_in_bytes":715849728}}},"threads":{"count":79,"peak_count":80},"gc":{"collectors":{"young":{"collection_count":5,"collection_time_in_millis":60},"old":{"collection_count":1,"collection_time_in_millis":16}}},"buffer_pools":{"direct":{"count":131,"used_in_bytes":22063045,"total_capacity_in_bytes":22063045},"mapped":{"count":0,"used_in_bytes":0,"total_capacity_in_bytes":0}},"classes":{"current_loaded_count":7343,"total_loaded_count":7343,"total_unloaded_count":0}},"thread_pool":{"bulk":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_started":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"fetch_shard_store":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"flush":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"generic":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":4,"completed":56},"get":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"index":{"threads":6,"queue":0,"active":0,"rejected":0,"largest":6,"completed":6},"listener":{"threads":4,"queue":0,"active":0,"rejected":0,"largest":4,"completed":161},"management":{"threads":2,"queue":0,"active":1,"rejected":0,"largest":2,"completed":88},"optimize":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"percolate":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"refresh":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":2},"search":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"snapshot":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"suggest":{"threads":0,"queue":0,"active":0,"rejected":0,"largest":0,"completed":0},"warmer":{"threads":2,"queue":0,"active":0,"rejected":0,"largest":2,"completed":6}},"fs":{"timestamp":1446052486386,"total":{"total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424},"data":[{"path":"/Users/leonardo.menezes/Downloads/elastic/elasticsearch-2.0.0/data/elasticsearch/nodes/0","mount":"/ (/dev/disk1)","type":"hfs","total_in_bytes":249804886016,"free_in_bytes":48731111424,"available_in_bytes":48468967424}]},"transport":{"server_open":13,"rx_count":134,"rx_size_in_bytes":111876,"tx_count":135,"tx_size_in_bytes":20942},"http":{"current_open":7,"total_opened":29},"breakers":{"request":{"limit_size_in_bytes":415183667,"limit_size":"395.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0},"fielddata":{"limit_size_in_bytes":622775500,"limit_size":"593.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.03,"tripped":0},"parent":{"limit_size_in_bytes":726571417,"limit_size":"692.9mb","estimated_size_in_bytes":0,"estimated_size":"0b","overhead":1.0,"tripped":0}},"script":{"compilations":0,"cache_evictions":0}}}}');
      var settings2 = JSON.parse('{"foobar":{"settings":{"index":{"creation_date":"1446052483693","analysis":{"analyzer":{"index_inc_search":{"filter":["lowercase"],"tokenizer":"whitespace"}}},"number_of_shards":"2","number_of_replicas":"0","uuid":"BzQapH-qT8GWdrOCm-mFKg","version":{"created":"2000099"}}}},"foobaz":{"settings":{"index":{"creation_date":"1446052484466","analysis":{"analyzer":{"index_inc_search":{"filter":["lowercase"],"tokenizer":"whitespace"}}},"number_of_shards":"1","number_of_replicas":"2","uuid":"mPg_arqrREiXzhnhi0w6jg","version":{"created":"2000099"}}}}}');
      var aliases2 = JSON.parse('{"foobar":{"aliases":{}},"foobaz":{"aliases":{}}}');
      var health2 = JSON.parse('{"cluster_name":"elasticsearch","status":"yellow","timed_out":false,"number_of_nodes":2,"number_of_data_nodes":2,"active_primary_shards":3,"active_shards":4,"relocating_shards":0,"initializing_shards":0,"unassigned_shards":1,"delayed_unassigned_shards":0,"number_of_pending_tasks":0,"number_of_in_flight_fetch":0,"task_max_waiting_in_queue_millis":0,"active_shards_percent_as_number":80.0}');
      var nodes2 = JSON.parse('{"cluster_name":"elasticsearch","nodes":{"4KsHvWKoQsiwQ7MJr0CpDA":{"name":"Nosferata","transport_address":"127.0.0.1:9301","host":"127.0.0.1","ip":"127.0.0.1","version":"2.0.0","build":"de54438","http_address":"127.0.0.1:9201","os":{"refresh_interval_in_millis":1000,"available_processors":8},"jvm":{"pid":31338,"version":"1.8.0_40","vm_name":"Java HotSpot(TM) 64-Bit Server VM","vm_version":"25.40-b25","vm_vendor":"Oracle Corporation","start_time_in_millis":1446052456821,"mem":{"heap_init_in_bytes":268435456,"heap_max_in_bytes":1037959168,"non_heap_init_in_bytes":2555904,"non_heap_max_in_bytes":0,"direct_max_in_bytes":1037959168},"gc_collectors":["ParNew","ConcurrentMarkSweep"],"memory_pools":["Code Cache","Metaspace","Compressed Class Space","Par Eden Space","Par Survivor Space","CMS Old Gen"]}},"JABXlsAfSWmjZ1YdzFsn9A":{"name":"Maur-Konn","transport_address":"127.0.0.1:9300","host":"127.0.0.1","ip":"127.0.0.1","version":"2.0.0","build":"de54438","http_address":"127.0.0.1:9200","os":{"refresh_interval_in_millis":1000,"name":"Mac OS X","arch":"x86_64","version":"10.10.5","available_processors":8},"jvm":{"pid":31005,"version":"1.8.0_40","vm_name":"Java HotSpot(TM) 64-Bit Server VM","vm_version":"25.40-b25","vm_vendor":"Oracle Corporation","start_time_in_millis":1446052374353,"mem":{"heap_init_in_bytes":268435456,"heap_max_in_bytes":1037959168,"non_heap_init_in_bytes":2555904,"non_heap_max_in_bytes":0,"direct_max_in_bytes":1037959168},"gc_collectors":["ParNew","ConcurrentMarkSweep"],"memory_pools":["Code Cache","Metaspace","Compressed Class Space","Par Eden Space","Par Survivor Space","CMS Old Gen"]}}}}');
      var cluster2 = new Cluster(health2, state2, indexStats2, nodeStats2, settings2, aliases2, nodes2, main);

      cluster2.computeChanges(cluster);
      ok(cluster2.changes.hasChanges() == false, "No changes");
    });
